<!DOCTYPE html>
<html>
<head>
	<title>Sushi JS UI Test Suite</title>
	<link rel="stylesheet" href="../qunit/qunit.css" type="text/css" media="screen">
	<script src="../qunit/qunit.js"></script>
	<script data-main="sushi.base.js" src="../../src/vendors/require.js"></script>
	<script>		
			runTests = function(Sushi) {
				Sushi.ready(function() {
					module("Alerts")
		
					test("should be defined on Sushi object", function () {
						ok($(document.body).alert, 'alert method is defined')
					})
				
					test("should return element", function () {
						ok($(document.body).alert()[0] == document.body, 'document.body returned')
					})
				
					test("should fade element out on clicking .close", function () {
						var alertHTML = '<div class="alert-message warning fade in">'
						  + '<a class="close" href="#" data-dismiss="alert">×</a>'
						  + '<p><strong>Holy guacamole!</strong> Best check yo self, you\'re not looking too good.</p>'
						  + '</div>'
						  , alert = $(alertHTML).appendTo('#qunit-fixture').alert()
				
						alert.find('.close').trigger('click')
				
						ok(!alert.hasClass('in'), 'remove .in class on .close click')
						
						alert.remove();
					})
				
					test("should remove element when clicking .close", function () {
						$.support.transition = false
				
						var alertHTML = '<div class="alert-message warning fade in">'
						  + '<a class="close" href="#" data-dismiss="alert">×</a>'
						  + '<p><strong>Holy guacamole!</strong> Best check yo self, you\'re not looking too good.</p>'
						  + '</div>'
						  , alert = $(alertHTML).appendTo('#qunit-fixture').alert()
				
						ok($('#qunit-fixture').find('.alert-message').length, 'element added to dom')
				
						alert.find('.close').trigger('click')
				
						ok(!$('#qunit-fixture').find('.alert-message').length, 'element removed from dom')
					})
				
					test("should not fire closed when close is prevented", function () {
						$.support.transition = false
						stop();
						$('<div class="alert"/>')
						  .bind('close', function (e) {
							e.preventDefault();
							ok(true);
							start();
						  })
						  .bind('closed', function () {
							ok(false);
						  })
						  .alert('close')
					})
					
					
					module("Buttons")
	
					  test("should be defined on jquery object", function () {
						ok($(document.body).button, 'button method is defined')
					  })
				
					  test("should return element", function () {
						ok($(document.body).button()[0] == document.body, 'document.body returned')
					  })
				
					  test("should return set state to loading", function () {
						var btn = $('<button class="btn" data-loading-text="fat">mdo</button>')
						equals(btn.html(), 'mdo', 'btn text equals mdo')
						btn.button('loading')
						equals(btn.html(), 'fat', 'btn text equals fat')
						stop()
						setTimeout(function () {
						  ok(btn.attr('disabled'), 'btn is disabled')
						  ok(btn.hasClass('disabled'), 'btn has disabled class')
						  start()
						}, 0)
					  })
				
					  test("should return reset state", function () {
						var btn = $('<button class="btn" data-loading-text="fat">mdo</button>')
						equals(btn.html(), 'mdo', 'btn text equals mdo')
						btn.button('loading')
						equals(btn.html(), 'fat', 'btn text equals fat')
						stop()
						setTimeout(function () {
						  ok(btn.attr('disabled'), 'btn is disabled')
						  ok(btn.hasClass('disabled'), 'btn has disabled class')
						  start()
						  stop()
						}, 0)
						btn.button('reset')
						equals(btn.html(), 'mdo', 'btn text equals mdo')
						setTimeout(function () {
						  ok(!btn.attr('disabled'), 'btn is not disabled')
						  ok(!btn.hasClass('disabled'), 'btn does not have disabled class')
						  start()
						}, 0)
					  })
				
					  test("should toggle active", function () {
						var btn = $('<button class="btn">mdo</button>')
						ok(!btn.hasClass('active'), 'btn does not have active class')
						btn.button('toggle')
						ok(btn.hasClass('active'), 'btn has class active')
					  })
				
					  test("should toggle active when btn children are clicked", function () {
						var btn = $('<button class="btn" data-toggle="button">mdo</button>')
						  , inner = $('<i></i>')
						btn
						  .append(inner)
						  .appendTo($('#qunit-fixture'))
						ok(!btn.hasClass('active'), 'btn does not have active class')
						$(btn.find('i')).trigger('click')
						ok(btn.hasClass('active'), 'btn has class active')
					  })
				
					 test("should toggle active when btn children are clicked within btn-group", function () {
						var btngroup = $('<div class="btn-group" data-toggle="buttons-checkbox"></div>')
						  , btn = $('<button class="btn">fat</button>')
						  , inner = $('<i></i>')
						btngroup
						  .append(btn.append(inner))
						  .appendTo($('#qunit-fixture'))
						ok(!btn.hasClass('active'), 'btn does not have active class')
						$(btngroup.find('.btn i')).trigger('click')
						ok($(btngroup.find('.btn')).hasClass('active'), 'btn has class active')
					  })
					  
					  module("Sushi carousel")
	
					  test("should be defined on Sushi object", function () {
						ok($(document.body).carousel, 'carousel method is defined')
					  })
				
					  test("should return element", function () {
						ok($(document.body).carousel()[0] == document.body, 'document.body returned')
					  })
				
					  test("should not fire sliden when slide is prevented", function () {
						$.support.transition = false
						stop();
						$('<div class="carousel"/>')
						  .bind('slide', function (e) {
							e.preventDefault();
							ok(true);
							start();
						  })
						  .bind('slid', function () {
							ok(false);
						  })
						  .carousel('next')
					  })
					  
					  module("Sushi collapse")
	
					  test("should be defined on Sushi object", function () {
						ok($(document.body).collapse, 'collapse method is defined')
					  })
				
					  test("should return element", function () {
						ok($(document.body).collapse()[0] == document.body, 'document.body returned')
					  })
				
					  test("should show a collapsed element", function () {
						var el = $('<div class="collapse"></div>').collapse('show')
						ok(el.hasClass('in'), 'has class in')
						ok(/height/.test(el.attr('style')), 'has height set')
					  })
				
					  test("should hide a collapsed element", function () {
						var el = $('<div class="collapse"></div>').collapse('hide')
						ok(!el.hasClass('in'), 'does not have class in')
						ok(/height/.test(el.attr('style')), 'has height set')
					  })
				
					  test("should not fire shown when show is prevented", function () {
						$.support.transition = false
						stop();
						$('<div class="collapse"/>')
						  .bind('show', function (e) {
							e.preventDefault();
							ok(true);
							start();
						  })
						  .bind('shown', function () {
							ok(false);
						  })
						  .collapse('show')
					  })
				
					  test("should reset style to auto after finishing opening collapse", function () {
						$.support.transition = false
						stop();
						$('<div class="collapse" style="height: 0px"/>')
						  .bind('show', function () {
							ok(this.style.height == '0px')
						  })
						  .bind('shown', function () {
							ok(this.style.height == 'auto')
							start()
						  })
						  .collapse('show')
					  })
					  
					  module("Sushi dropdowns")
	
					  test("should be defined on jquery object", function () {
						ok($(document.body).dropdown, 'dropdown method is defined')
					  })
				
					  test("should return element", function () {
						ok($(document.body).dropdown()[0] == document.body, 'document.body returned')
					  })
				
					  test("should not open dropdown if target is disabled", function () {
						var dropdownHTML = '<ul class="tabs">'
						  + '<li class="dropdown">'
						  + '<button disabled href="#" class="btn dropdown-toggle" data-toggle="dropdown">Dropdown</button>'
						  + '<ul class="dropdown-menu">'
						  + '<li><a href="#">Secondary link</a></li>'
						  + '<li><a href="#">Something else here</a></li>'
						  + '<li class="divider"></li>'
						  + '<li><a href="#">Another link</a></li>'
						  + '</ul>'
						  + '</li>'
						  + '</ul>'
						  , dropdown = $(dropdownHTML).find('[data-toggle="dropdown"]').dropdown().trigger('click')
				
						ok(!dropdown.parent('.dropdown').hasClass('open'), 'open class added on click')
					  })
				
					  test("should not open dropdown if target is disabled", function () {
						var dropdownHTML = '<ul class="tabs">'
						  + '<li class="dropdown">'
						  + '<button href="#" class="btn dropdown-toggle disabled" data-toggle="dropdown">Dropdown</button>'
						  + '<ul class="dropdown-menu">'
						  + '<li><a href="#">Secondary link</a></li>'
						  + '<li><a href="#">Something else here</a></li>'
						  + '<li class="divider"></li>'
						  + '<li><a href="#">Another link</a></li>'
						  + '</ul>'
						  + '</li>'
						  + '</ul>'
						  , dropdown = $(dropdownHTML).find('[data-toggle="dropdown"]').dropdown().trigger('click')
	
						ok(!dropdown.parent('.dropdown').hasClass('open'), 'open class added on click')
					  })
				
					  test("should add class open to menu if clicked", function () {
						var dropdownHTML = '<ul class="tabs">'
						  + '<li class="dropdown">'
						  + '<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a>'
						  + '<ul class="dropdown-menu">'
						  + '<li><a href="#">Secondary link</a></li>'
						  + '<li><a href="#">Something else here</a></li>'
						  + '<li class="divider"></li>'
						  + '<li><a href="#">Another link</a></li>'
						  + '</ul>'
						  + '</li>'
						  + '</ul>'
						  , dropdown = $(dropdownHTML).find('[data-toggle="dropdown"]').dropdown().trigger('click')
						ok($(dropdown.parent('.dropdown')).hasClass('open'), 'open class added on click')
					  })
				
					  test("should remove open class if body clicked", function () {
						var dropdownHTML = '<ul class="tabs">'
						  + '<li class="dropdown">'
						  + '<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a>'
						  + '<ul class="dropdown-menu">'
						  + '<li><a href="#">Secondary link</a></li>'
						  + '<li><a href="#">Something else here</a></li>'
						  + '<li class="divider"></li>'
						  + '<li><a href="#">Another link</a></li>'
						  + '</ul>'
						  + '</li>'
						  + '</ul>'
						  , dropdown = $(dropdownHTML)
							.appendTo('#qunit-fixture')
							.find('[data-toggle="dropdown"]')
							.trigger('click')
						ok(dropdown.parent('.dropdown').hasClass('open'), 'open class added on click')
						$('body').trigger('click')
						ok(!dropdown.parent('.dropdown').hasClass('open'), 'open class removed')
						dropdown.remove()
					  })
					  
					  module("Sushi modal")
	
					  test("should be defined on Sushi object", function () {
						var div = $("<div id='modal-test'></div>")
						ok(div.modal, 'modal method is defined')
					  })
				
					  test("should return element", function () {
						var div = $("<div id='modal-test'></div>")
						ok(div.modal() == div, 'document.body returned')
						$('#modal-test').remove()
					  })
				
					  test("should expose defaults var for settings", function () {
						ok($.fn.modal.defaults, 'default object exposed')
					  })
				
					  test("should insert into dom when show method is called", function () {
						stop()
						$.support.transition = false
						$("<div id='modal-test'></div>")
						  .bind("shown", function () {
							ok($('#modal-test').length, 'modal insterted into dom')
							$(this).remove()
							start()
							$('#modal-test').remove();
						  })
						  .modal("show")
					  })
				
					  test("should fire show event", function () {
						stop()
						$.support.transition = false
						$("<div id='modal-test'></div>")
						  .bind("show", function () {
							ok(true, "show was called")
						  })
						  .bind("shown", function () {
							$(this).remove()
							start()
							$('#modal-test').remove();
						  })
						  .modal("show")
					  })
				
					  test("should not fire shown when default prevented", function () {
						stop()
						$.support.transition = false
						$("<div id='modal-test'></div>")
						  .bind("show", function (e) {
							e.preventDefault()
							ok(true, "show was called")
							start()
						  })
						  .bind("shown", function () {
							ok(false, "shown was called")
							$('#modal-test').remove();
						  })
						  .modal("show")
					  })
				
					  test("should hide modal when hide is called", function () {
						stop()
						$.support.transition = false
				
						$("<div id='modal-test'></div>")
						  .bind("shown", function () {
							ok($('#modal-test').isVisible(), 'modal visible')
							ok($('#modal-test').length, 'modal insterted into dom')
							$(this).modal("hide")
						  })
						  .bind("hidden", function() {
							ok(!$('#modal-test').isVisible(), 'modal hidden')
							$('#modal-test').remove()
							start()
						  })
						  .modal("show")
					  })
				
					  test("should toggle when toggle is called", function () {
						stop()
						$.support.transition = false
						var div = $("<div id='modal-test'></div>")
						div
						  .bind("shown", function () {
							ok($('#modal-test').isVisible(), 'modal visible')
							ok($('#modal-test').length, 'modal insterted into dom')
							div.modal("toggle")
						  })
						  .bind("hidden", function() {
							ok(!$('#modal-test').isVisible(), 'modal hidden')
							$('#modal-test').remove()
							start()
						  })
						  .modal("toggle")
					  })
				
					  test("should remove from dom when click [data-dismiss=modal]", function () {
						stop()
						$.support.transition = false
						var div = $("<div id='modal-test'><span class='close' data-dismiss='modal'></span></div>")
						div.appendTo('body');
						$('#modal-test')
						  .bind("shown", function () {
							ok($('#modal-test').isVisible(), 'modal visible')
							ok($('#modal-test').length, 'modal insterted into dom')
							$('#modal-test').find('.close').trigger('click')
						  })
						  .bind("hidden", function() {
							ok(!$('#modal-test').isVisible(), 'modal hidden')
							$('#modal-test').remove()
							start()
						  })
						  .modal("toggle")
					  })
					  
					  module("Sushi Popover")

					  test("should be defined on Sushi object", function () {
						var div = $('<div></div>')
						ok(div.popover, 'popover method is defined')
					  })
				
					  test("should return element", function () {
						var div = $('<div></div>')
						ok(div.popover() == div, 'document.body returned')
					  })
				
					  test("should render popover element", function () {
						$.support.transition = false
						var popover = $('<a href="#" title="mdo" data-content="http://twitter.com/mdo">@mdo</a>')
						  .appendTo('#qunit-fixture')
						  .popover('show')
				
						ok($('.popover').length, 'popover was inserted')
						popover.popover('hide')
						ok(!$(".popover").length, 'popover removed')
					  })
				
					  test("should store popover instance in popover data object", function () {
						$.support.transition = false
						var popover = $('<a href="#" title="mdo" data-content="http://twitter.com/mdo">@mdo</a>')
						  .popover()
				
						ok(!!popover.data('popover'), 'popover instance exists')
					  })
				
					  test("should get title and content from options", function () {
						$.support.transition = false
						var popover = $('<a href="#">@fat</a>')
						  .appendTo('#qunit-fixture')
						  .popover({
							title: function () {
							  return '@fat'
							}
						  , content: function () {
							  return 'loves writing tests （╯°□°）╯︵ ┻━┻'
							}
						  })
				
						popover.popover('show')
				
						ok($('.popover').length, 'popover was inserted')
						equals($('.popover .popover-title').text(), '@fat', 'title correctly inserted')
						equals($('.popover .popover-content').text(), 'loves writing tests （╯°□°）╯︵ ┻━┻', 'content correctly inserted')
				
						popover.popover('hide')
						ok(!$('.popover').length, 'popover was removed')
						$('#qunit-fixture').empty()
					  })
				
					  test("should get title and content from attributes", function () {
						$.support.transition = false
						var popover = $('<a href="#" title="@mdo" data-content="loves data attributes (づ｡◕‿‿◕｡)づ ︵ ┻━┻" >@mdo</a>')
						  .appendTo('#qunit-fixture')
						  .popover()
						  .popover('show')
				
						ok($('.popover').length, 'popover was inserted')
						equals($('.popover .popover-title').text(), '@mdo', 'title correctly inserted')
						equals($('.popover .popover-content').text(), "loves data attributes (づ｡◕‿‿◕｡)づ ︵ ┻━┻", 'content correctly inserted')
				
						popover.popover('hide')
						ok(!$('.popover').length, 'popover was removed')
						$('#qunit-fixture').empty()
					  })
					
					  test("should respect custom classes", function() {
						$.support.transition = false
						var popover = $('<a href="#">@fat</a>')
						  .appendTo('#qunit-fixture')
						  .popover({
							title: 'Test'
						  , content: 'Test'
						  , template: '<div class="popover foobar"><div class="arrow"></div><div class="inner"><h3 class="title"></h3><div class="content"><p></p></div></div></div>'
						  })
						
						popover.popover('show')
				
						ok($('.popover').length, 'popover was inserted')
						ok($('.popover').hasClass('foobar'), 'custom class is present')
				
						popover.popover('hide')
						ok(!$('.popover').length, 'popover was removed')
						$('#qunit-fixture').empty()
					  })
					  
					   module("Sushi scrollspy")

					  test("should be defined on Sushi object", function () {
						ok($(document.body).scrollspy, 'scrollspy method is defined')
					  })
				
					  test("should return element", function () {
						ok($(document.body).scrollspy()[0] == document.body, 'document.body returned')
					  })
				
					  test("should switch active class on scroll", function () {
						var sectionHTML = '<div id="masthead"></div>'
						  , $section = $(sectionHTML).append('#qunit-fixture')
						  , topbarHTML ='<div class="topbar">'
						  + '<div class="topbar-inner">'
						  + '<div class="container">'
						  + '<h3><a href="#">Bootstrap</a></h3>'
						  + '<ul class="nav">'
						  + '<li><a href="#masthead">Overview</a></li>'
						  + '</ul>'
						  + '</div>'
						  + '</div>'
						  + '</div>'
						  , $topbar = $(topbarHTML).scrollspy()
				
						ok($topbar.find('.active', true))
					  })
				});
			}
	</script>
</head>
<body>
	<h1 id="qunit-header">Sushi.UI Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture"></div>
</body>
</html>